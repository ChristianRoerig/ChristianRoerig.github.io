<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="The markdown aims to illustrate how to use specific location data and polygons to visualize data using ggmap.">

  
  <link rel="alternate" hreflang="en-us" href="/project/brazil/">

  


  
  
  
  <meta name="theme-color" content="#0072bb">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hud4354e72a179b83dbf54c1e4b63b69a5_266212_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hud4354e72a179b83dbf54c1e4b63b69a5_266212_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/project/brazil/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Christian Roerig">
  <meta property="og:url" content="/project/brazil/">
  <meta property="og:title" content="Rio de Janeiro crime map | Christian Roerig">
  <meta property="og:description" content="The markdown aims to illustrate how to use specific location data and polygons to visualize data using ggmap."><meta property="og:image" content="/project/brazil/featured.png">
  <meta property="twitter:image" content="/project/brazil/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2019-11-20T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2019-11-20T00:00:00&#43;00:00">
  

  


    









<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/project/brazil/"
  },
  "headline": "Rio de Janeiro crime map",
  
  "image": [
    "/project/brazil/featured.png"
  ],
  
  "datePublished": "2019-11-20T00:00:00Z",
  "dateModified": "2019-11-20T00:00:00Z",
  
  "publisher": {
    "@type": "Organization",
    "name": "Christian Roerig",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/icon_hud4354e72a179b83dbf54c1e4b63b69a5_266212_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "The markdown aims to illustrate how to use specific location data and polygons to visualize data using ggmap."
}
</script>

  

  


  


  





  <title>Rio de Janeiro crime map | Christian Roerig</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Christian Roerig</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Christian Roerig</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/research/"><span>Research</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#teaching_experience"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/codes/"><span>Codes</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/CV_Roerig_05_20.pdf"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      

      

      

    </ul>

  </div>
</nav>


  <article class="article article-project">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Rio de Janeiro crime map</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Nov 20, 2019
  </span>
  

  

  

  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      


<p>This markdown is based on work related to the project “Religion as an insurance” (joint work with Tiago Cavalcanti, Sriya Iyer, Chris Rauh and Maryam Vaziri) in which we use primary data from Rio de Janeiro about people’s socioeconomic circumstances, their perception about the future and their religiousness. The markdown aims to illustrate how to use specific location data and polygons to visualize data using ggmap.</p>
<div id="load-the-dataset" class="section level3">
<h3>Load the dataset</h3>
<pre class="r"><code>brazil_dta &lt;- read_dta(&quot;brazil.dta&quot;)</code></pre>
</div>
<div id="plot-map-of-rio-de-janeiro-and-locations-of-interviewees" class="section level3">
<h3>Plot map of Rio de Janeiro and locations of interviewees</h3>
<pre class="r"><code>qmplot(longitude,latitude,data=brazil_dta,mapcolor=&quot;bw&quot;,source=&quot;stamen&quot;,maptype = &quot;terrain&quot;,zoom=10,color=&quot;red&quot;,alpha=0.5,size=1,extent = &quot;device&quot;,margins=TRUE)+
  theme_set(theme_bw())+
  theme(legend.position = &quot;none&quot;)+
  xlab(&quot;longitude&quot;)+
  ylab(&quot;latitute&quot;)</code></pre>
<p><img src="/project/Brazil/index_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="plot-police-districts-from-shapefile" class="section level3">
<h3>Plot police districts from shapefile</h3>
<pre class="r"><code>require(rgdal)
require(ggplot2)
shp &lt;- raster::shapefile(&quot;lm_dp_2019.shp&quot;)

summary(shp@data)</code></pre>
<pre><code>##       dp                aisp             st_area_sh          st_length_     
##  Length:137         Length:137         Min.   :0.0001266   Min.   :0.05798  
##  Class :character   Class :character   1st Qu.:0.0016328   1st Qu.:0.28136  
##  Mode  :character   Mode  :character   Median :0.0148845   Median :0.76807  
##                                        Mean   :0.0279889   Mean   :0.93000  
##                                        3rd Qu.:0.0418780   3rd Qu.:1.38483  
##                                        Max.   :0.2328915   Max.   :4.98608</code></pre>
<pre class="r"><code>map &lt;- ggplot() + geom_polygon(data = shp, aes(x = long, y = lat, group = group), colour = &quot;black&quot;, fill = NA)
map + theme_void()</code></pre>
<p><img src="/project/Brazil/index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>shp &lt;- spTransform(shp, CRS(&quot;+proj=longlat +datum=WGS84&quot;))</code></pre>
</div>
<div id="plot-maps-visualizing-crime-stats-per-police-district" class="section level3">
<h3>Plot maps visualizing crime stats per police district</h3>
<p>In fact, we combine official crime stats per police district such as murders, robberies and thefts per capita with interviewees’ perception of safety.</p>
<pre class="r"><code>crime_data &lt;- read.csv(&quot;BaseDPEvolucaoMensalCisp.csv&quot;,sep=&quot;;&quot;)
population &lt;- read.csv(&quot;PopulacaoEvolucaoAnualCisp.csv&quot;,sep=&quot;;&quot;)

# group crime data for year 2018
crime_data %&gt;%  
  left_join(population,by=c(&quot;vano&quot;, &quot;CISP&quot;=&quot;circ&quot;)) %&gt;% 
  filter(vano==&quot;2018&quot;) %&gt;% 
  group_by(CISP) %&gt;% 
  summarise(abs_hom_doloso=sum(hom_doloso),
            abs_roubos=sum(total_roubos),
            abs_furtos=sum(total_furtos),
            pc_hom_doloso=sum(hom_doloso/as.numeric(pop)),
            pc_total_roubos=sum(total_roubos/as.numeric(pop)),
            pc_total_furtos=sum(total_furtos/as.numeric(pop))) -&gt; crime_data_2018

# treat outlier island
crime_data_CISP1 &lt;- crime_data_2018 %&gt;% 
  filter(CISP==1) %&gt;% 
  mutate(pc_hom_doloso=NA,
         pc_total_roubos=NA,
         pc_total_furtos=NA)
crime_data_2018 &lt;- rbind(crime_data_CISP1,crime_data_2018[crime_data_2018$CISP!=1,])

shp_df &lt;- fortify(shp, region = &quot;dp&quot;)
shp_crime &lt;- merge(shp_df, crime_data_2018, by.x=&quot;id&quot;,by.y=&quot;CISP&quot;)

# plot shape file with crime data on map
ggplot()+
  geom_polygon(aes(x=long, y=lat, group=group, fill= pc_hom_doloso), size=.2,color=&#39;black&#39;, data=shp_crime, alpha=1)+
  scale_fill_gradient(high = &quot;#FF6347&quot;, low = &quot;#90EE90&quot;,name=&quot;murders per capita in 2018&quot;)+
  geom_point(aes(x=longitude,y=latitude,color=as.numeric(as_factor(safety))),alpha=1,data=brazil_dta)+
  scale_color_gradient(high = &quot;#00FF00&quot;, low = &quot;#FF0000&quot;,name=&quot;perceived safety&quot;,limits=c(0,10))+
  coord_map(xlim = c(-44, -42.75),ylim = c(-23.1, -22.5))</code></pre>
<p><img src="/project/Brazil/index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code># plot shape file with crime data on map
ggplot()+
  geom_polygon(aes(x=long, y=lat, group=group, fill= pc_total_roubos), size=.2,color=&#39;black&#39;, data=shp_crime, alpha=1)+
  scale_fill_gradient(high = &quot;#FF6347&quot;, low = &quot;#90EE90&quot;,name=&quot;robberies per capita in 2018&quot;)+
  geom_point(aes(x=longitude,y=latitude,color=as.numeric(as_factor(safety))),alpha=1,data=brazil_dta)+
  scale_color_gradient(high = &quot;#00FF00&quot;, low = &quot;#FF0000&quot;,name=&quot;perceived safety&quot;,limits=c(0,10))+
  coord_map(xlim = c(-44, -42.75),ylim = c(-23.1, -22.5))</code></pre>
<p><img src="/project/Brazil/index_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<pre class="r"><code># plot shape file with crime data on map
ggplot()+
  geom_polygon(aes(x=long, y=lat, group=group, fill= pc_total_furtos), size=.2,color=&#39;black&#39;, data=shp_crime, alpha=1)+
  scale_fill_gradient(high = &quot;#FF6347&quot;, low = &quot;#90EE90&quot;,name=&quot;thefts per capita in 2018&quot;)+
  geom_point(aes(x=longitude,y=latitude,color=as.numeric(as_factor(safety))),alpha=1,data=brazil_dta)+
  scale_color_gradient(high = &quot;#00FF00&quot;, low = &quot;#FF0000&quot;,name=&quot;perceived safety&quot;,limits=c(0,10))+
  coord_map(xlim = c(-44, -42.75),ylim = c(-23.1, -22.5))</code></pre>
<p><img src="/project/Brazil/index_files/figure-html/unnamed-chunk-4-3.png" width="672" /></p>
</div>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/r/">R</a>
  
</div>














  
  





  
    
    
    
      
    
    
    
    <div class="media author-card content-widget-hr">
      
        
        <img class="avatar mr-3 avatar-circle" src="/author/avatar_hu099716702c20a56d99ff50bd2b2ebb87_1847286_270x270_fill_q90_lanczos_center.jpg" alt="">
      

      <div class="media-body">
        <h5 class="card-title"><a href="/"></a></h5>
        <h6 class="card-subtitle">Economics PhD student</h6>
        <p class="card-text">My research interests include macroeconomics, development economics, applied econometrics and machine learning.</p>
        <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:cmr61@cam.ac.uk" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="skype:Chriss2391?call" >
        <i class="fab fa-skype"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/christian-r%C3%B6rig-177a2a81/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/ChristianRoerig" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

      </div>
    </div>
  












  
  



    <div class="project-related-pages content-widget-hr">
      
      

      
      
      

      
      
      

      
      
      
    </div>
  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    

    
    

    

    
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academic.min.6f7ce8be710290b8c431bbc97f405d15.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    © 2021
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
